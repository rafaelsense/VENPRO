   LOG VENPRO 2015-10-07
_________________________________________________________
---------------------------------------------------------

2015-10-07 0:21:47 : Error import_archivo.MoveOld(). No se pudo mover  ORIGEN:[E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A409.XML].DESTINO:[E:\VENPRO\VENPRO\bin\Debug\import\103\old\TRPER20141219A409.XML] System.IO.FileNotFoundException: No se pudo encontrar el archivo 'E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A409.XML'.
Nombre de archivo: 'E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A409.XML'
   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   en System.IO.File.Move(String sourceFileName, String destFileName)
   en VENPRO.Form1.import_archivo(String fecha_venpro, Int64 codtienda, String ruta) en E:\VENPRO\VENPRO\Form1.cs:línea 1643
2015-10-07 0:21:47 : Error.delete_archivoimport_mysql(). System.NullReferenceException: Referencia a objeto no establecida como instancia de un objeto.
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 5010
2015-10-07 0:21:59 : Error.insert_RPE_archivoimport_mysql(). Error en la sentencia. [codtabla: {33} - nomtabla: {signon}
ValorFILA: [32], [11], [1990], [107], [2014-12-19], [07:26:48], [0], [0], [0], [0], [0], [26272], [1355], [186], [0104], []
]Archivo:[TRPER20141219A416.XML]
Fecha: [2015-10-07]
tienda: [104]
[INSERT INTO signon ( archivo_venpro,fecha_venpro, codtienda_venpro, Tr_Log, Log_SignOn, ClaveCajero, Tail_NumTicketSL, Tail_Fecha, Tail_Hora, Tail_Devolucion, Tail_Training, Tail_Offline, Tail_TicketCancelado, Tail_BadRec, Sequence_ID, Tail_NumCajero, Tail_NumPOS, StoreNumber, TailSeqHighByte ) 
                                    values ( 'TRPER20141219A416.XML' , '2015-10-07' ,104, @Tr_Log, @Log_SignOn, @ClaveCajero, @Tail_NumTicketSL, @Tail_Fecha, @Tail_Hora, @Tail_Devolucion, @Tail_Training, @Tail_Offline, @Tail_TicketCancelado, @Tail_BadRec, @Sequence_ID, @Tail_NumCajero, @Tail_NumPOS, @StoreNumber, @TailSeqHighByte )] . MySql.Data.MySqlClient.MySqlException (0x80004005): Duplicate entry '2014-12-19-26272-186-104' for key 'PRIMARY'
   en MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   en MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.GetResult(Int32 statementId, Int32& affectedRows, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   en MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery()
   en VENPRO.cldatos.insert_archivoimport_Mysql(MySqlConnection cnMysql_BD, String fecha_venpro, Int64 codtienda_venpro, String archivo_venpro, Int64 codtabla, String nomtabla, String modoactualizacion, Int32 colposicionupdate, Int32 colposicionupdate1, Int32 colposicionupdate2, Int32 colposicionupdate3, Int32 colposicionupdate4, Int32 colposicionupdate5, Int32 colposicionupdate6, Int32 colposicionupdate7, DataRow[] rwcolumnas, List`1 v_columnaxFila, List`1 v_valorxFila) en E:\VENPRO\VENPRO\cldatos.cs:línea 5513
2015-10-07 0:21:59 : procesarxml().Se elimino Archivo.[E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A416.XML] 
2015-10-07 0:22:3 : Error import_archivo.MoveOld(). No se pudo mover  ORIGEN:[E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A416.XML].DESTINO:[E:\VENPRO\VENPRO\bin\Debug\import\104\old\TRPER20141219A416.XML] System.IO.FileNotFoundException: No se pudo encontrar el archivo 'E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A416.XML'.
Nombre de archivo: 'E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A416.XML'
   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   en System.IO.File.Move(String sourceFileName, String destFileName)
   en VENPRO.Form1.import_archivo(String fecha_venpro, Int64 codtienda, String ruta) en E:\VENPRO\VENPRO\Form1.cs:línea 1643
2015-10-07 0:22:10 : Error.insert_RPE_archivoimport_mysql(). Error en la sentencia. [codtabla: {2} - nomtabla: {frame}
ValorFILA: [33], [1], [0], [0], [3541], [0], [0], [3541], [2014-12-19], [07:31:13], [0], [0], [0], [1], [0], [5096], [1063], [29], [0103], []
]Archivo:[TRPER20141219A410.XML]
Fecha: [2015-10-07]
tienda: [103]
[INSERT INTO frame ( archivo_venpro,fecha_venpro, codtienda_venpro, Tr_Frame, StartofTicket, TenderPurchase, PostVoid, TicketNumber, VoidTicketNumber, NoSale, Tail_NumTicketSL, Tail_Fecha, Tail_Hora, Tail_Devolucion, Tail_Training, Tail_Offline, Tail_TicketCancelado, Tail_BadRec, Sequence_ID, Tail_NumCajero, Tail_NumPOS, StoreNumber, TailSeqHighByte ) 
                                    values ( 'TRPER20141219A410.XML' , '2015-10-07' ,103, @Tr_Frame, @StartofTicket, @TenderPurchase, @PostVoid, @TicketNumber, @VoidTicketNumber, @NoSale, @Tail_NumTicketSL, @Tail_Fecha, @Tail_Hora, @Tail_Devolucion, @Tail_Training, @Tail_Offline, @Tail_TicketCancelado, @Tail_BadRec, @Sequence_ID, @Tail_NumCajero, @Tail_NumPOS, @StoreNumber, @TailSeqHighByte )] . MySql.Data.MySqlClient.MySqlException (0x80004005): Duplicate entry '2014-12-19-5096-29-103' for key 'PRIMARY'
   en MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   en MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.GetResult(Int32 statementId, Int32& affectedRows, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   en MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery()
   en VENPRO.cldatos.insert_archivoimport_Mysql(MySqlConnection cnMysql_BD, String fecha_venpro, Int64 codtienda_venpro, String archivo_venpro, Int64 codtabla, String nomtabla, String modoactualizacion, Int32 colposicionupdate, Int32 colposicionupdate1, Int32 colposicionupdate2, Int32 colposicionupdate3, Int32 colposicionupdate4, Int32 colposicionupdate5, Int32 colposicionupdate6, Int32 colposicionupdate7, DataRow[] rwcolumnas, List`1 v_columnaxFila, List`1 v_valorxFila) en E:\VENPRO\VENPRO\cldatos.cs:línea 5513
2015-10-07 0:22:10 : procesarxml().Se elimino Archivo.[E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A410.XML] 
2015-10-07 0:22:17 : Error.delete_archivoimport_mysql().[delete from signon where fecha_venpro='2015-10-07' and codtienda_venpro=104 and archivo_venpro='TRPER20141219A448.XML' ;]. System.InvalidOperationException: Nested transactions are not supported.
   en MySql.Data.MySqlClient.ExceptionInterceptor.Throw(Exception exception)
   en MySql.Data.MySqlClient.MySqlConnection.Throw(Exception ex)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction(IsolationLevel iso)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction()
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 4968
2015-10-07 0:22:21 : Error import_archivo.MoveOld(). No se pudo mover  ORIGEN:[E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A410.XML].DESTINO:[E:\VENPRO\VENPRO\bin\Debug\import\103\old\TRPER20141219A410.XML] System.IO.FileNotFoundException: No se pudo encontrar el archivo 'E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A410.XML'.
Nombre de archivo: 'E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A410.XML'
   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   en System.IO.File.Move(String sourceFileName, String destFileName)
   en VENPRO.Form1.import_archivo(String fecha_venpro, Int64 codtienda, String ruta) en E:\VENPRO\VENPRO\Form1.cs:línea 1643
2015-10-07 0:22:21 : Error.delete_archivoimport_mysql(). System.NullReferenceException: Referencia a objeto no establecida como instancia de un objeto.
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 5010
2015-10-07 0:22:24 : Error.delete_archivoimport_mysql().[delete from frame where fecha_venpro='2015-10-07' and codtienda_venpro=103 and archivo_venpro='TRPER20141219A443.XML' ;]. System.InvalidOperationException: Nested transactions are not supported.
   en MySql.Data.MySqlClient.ExceptionInterceptor.Throw(Exception exception)
   en MySql.Data.MySqlClient.MySqlConnection.Throw(Exception ex)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction(IsolationLevel iso)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction()
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 4968
2015-10-07 0:22:24 : Error.delete_archivoimport_mysql(). System.NullReferenceException: Referencia a objeto no establecida como instancia de un objeto.
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 5010
2015-10-07 0:22:31 : Error Enviar Email. System.Net.Mail.SmtpException: Error al enviar correo. ---> System.Net.WebException: No es posible conectar con el servidor remoto ---> System.Net.Sockets.SocketException: No se puede establecer una conexión ya que el equipo de destino denegó expresamente dicha conexión 192.168.130.139:25
   en System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   en System.Net.ServicePoint.ConnectSocketInternal(Boolean connectFailure, Socket s4, Socket s6, Socket& socket, IPAddress& address, ConnectSocketState state, IAsyncResult asyncResult, Int32 timeout, Exception& exception)
   --- Fin del seguimiento de la pila de la excepción interna ---
   en System.Net.ServicePoint.GetConnection(PooledStream PooledStream, Object owner, Boolean async, IPAddress& address, Socket& abortSocket, Socket& abortSocket6, Int32 timeout)
   en System.Net.PooledStream.Activate(Object owningObject, Boolean async, Int32 timeout, GeneralAsyncDelegate asyncCallback)
   en System.Net.PooledStream.Activate(Object owningObject, GeneralAsyncDelegate asyncCallback)
   en System.Net.ConnectionPool.GetConnection(Object owningObject, GeneralAsyncDelegate asyncCallback, Int32 creationTimeout)
   en System.Net.Mail.SmtpConnection.GetConnection(ServicePoint servicePoint)
   en System.Net.Mail.SmtpTransport.GetConnection(ServicePoint servicePoint)
   en System.Net.Mail.SmtpClient.GetConnection()
   en System.Net.Mail.SmtpClient.Send(MailMessage message)
   --- Fin del seguimiento de la pila de la excepción interna ---
   en System.Net.Mail.SmtpClient.Send(MailMessage message)
   en VENPRO.globales.NewMail(String NombreMostrar, String De, String To, String CC, String CCO, String Asunto, String Body, String adjuntos) en E:\VENPRO\VENPRO\globales.cs:línea 744
2015-10-07 0:22:31 : Error. No se logro importar import_archivo(). [E:\VENPRO\VENPRO\bin\Debug\import\118\tmp\TRPER20141009A1149.XML]
2015-10-07 0:22:32 : Error. No se logro importar import_archivo(). [E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A443.XML]
2015-10-07 0:22:33 : Error. No se logro importar import_archivo(). [E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A448.XML]
2015-10-07 0:22:34 : Error.insert_RPE_archivoimport_mysql(). Error en la sentencia. [codtabla: {2} - nomtabla: {frame}
ValorFILA: [33], [1], [0], [0], [1097], [0], [0], [1097], [2014-12-19], [08:06:24], [0], [0], [0], [0], [0], [41323], [6547], [11], [0103], []
]Archivo:[TRPER20141219A446.XML]
Fecha: [2015-10-07]
tienda: [103]
[INSERT INTO frame ( archivo_venpro,fecha_venpro, codtienda_venpro, Tr_Frame, StartofTicket, TenderPurchase, PostVoid, TicketNumber, VoidTicketNumber, NoSale, Tail_NumTicketSL, Tail_Fecha, Tail_Hora, Tail_Devolucion, Tail_Training, Tail_Offline, Tail_TicketCancelado, Tail_BadRec, Sequence_ID, Tail_NumCajero, Tail_NumPOS, StoreNumber, TailSeqHighByte ) 
                                    values ( 'TRPER20141219A446.XML' , '2015-10-07' ,103, @Tr_Frame, @StartofTicket, @TenderPurchase, @PostVoid, @TicketNumber, @VoidTicketNumber, @NoSale, @Tail_NumTicketSL, @Tail_Fecha, @Tail_Hora, @Tail_Devolucion, @Tail_Training, @Tail_Offline, @Tail_TicketCancelado, @Tail_BadRec, @Sequence_ID, @Tail_NumCajero, @Tail_NumPOS, @StoreNumber, @TailSeqHighByte )] . MySql.Data.MySqlClient.MySqlException (0x80004005): Duplicate entry '2014-12-19-41323-11-103' for key 'PRIMARY'
   en MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   en MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.GetResult(Int32 statementId, Int32& affectedRows, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   en MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery()
   en VENPRO.cldatos.insert_archivoimport_Mysql(MySqlConnection cnMysql_BD, String fecha_venpro, Int64 codtienda_venpro, String archivo_venpro, Int64 codtabla, String nomtabla, String modoactualizacion, Int32 colposicionupdate, Int32 colposicionupdate1, Int32 colposicionupdate2, Int32 colposicionupdate3, Int32 colposicionupdate4, Int32 colposicionupdate5, Int32 colposicionupdate6, Int32 colposicionupdate7, DataRow[] rwcolumnas, List`1 v_columnaxFila, List`1 v_valorxFila) en E:\VENPRO\VENPRO\cldatos.cs:línea 5513
2015-10-07 0:22:34 : procesarxml().Se elimino Archivo.[E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A446.XML] 
2015-10-07 0:22:39 : Error import_archivo.MoveOld(). No se pudo mover  ORIGEN:[E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A446.XML].DESTINO:[E:\VENPRO\VENPRO\bin\Debug\import\103\old\TRPER20141219A446.XML] System.IO.FileNotFoundException: No se pudo encontrar el archivo 'E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A446.XML'.
Nombre de archivo: 'E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A446.XML'
   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   en System.IO.File.Move(String sourceFileName, String destFileName)
   en VENPRO.Form1.import_archivo(String fecha_venpro, Int64 codtienda, String ruta) en E:\VENPRO\VENPRO\Form1.cs:línea 1643
2015-10-07 0:22:39 : Error.delete_archivoimport_mysql().[delete from frame where fecha_venpro='2015-10-07' and codtienda_venpro=103 and archivo_venpro='TRPER20141219A447.XML' ;]. System.InvalidOperationException: Nested transactions are not supported.
   en MySql.Data.MySqlClient.ExceptionInterceptor.Throw(Exception exception)
   en MySql.Data.MySqlClient.MySqlConnection.Throw(Exception ex)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction(IsolationLevel iso)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction()
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 4968
2015-10-07 0:22:39 : Error.delete_archivoimport_mysql(). System.NullReferenceException: Referencia a objeto no establecida como instancia de un objeto.
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 5010
2015-10-07 0:22:40 : Error.insert_RPE_archivoimport_mysql(). Error en la sentencia. [codtabla: {33} - nomtabla: {signon}
ValorFILA: [32], [11], [2702], [3005], [2014-12-19], [08:00:25], [0], [0], [0], [0], [0], [2434], [68], [202], [0104], []
]Archivo:[TRPER20141219A449.XML]
Fecha: [2015-10-07]
tienda: [104]
[INSERT INTO signon ( archivo_venpro,fecha_venpro, codtienda_venpro, Tr_Log, Log_SignOn, ClaveCajero, Tail_NumTicketSL, Tail_Fecha, Tail_Hora, Tail_Devolucion, Tail_Training, Tail_Offline, Tail_TicketCancelado, Tail_BadRec, Sequence_ID, Tail_NumCajero, Tail_NumPOS, StoreNumber, TailSeqHighByte ) 
                                    values ( 'TRPER20141219A449.XML' , '2015-10-07' ,104, @Tr_Log, @Log_SignOn, @ClaveCajero, @Tail_NumTicketSL, @Tail_Fecha, @Tail_Hora, @Tail_Devolucion, @Tail_Training, @Tail_Offline, @Tail_TicketCancelado, @Tail_BadRec, @Sequence_ID, @Tail_NumCajero, @Tail_NumPOS, @StoreNumber, @TailSeqHighByte )] . MySql.Data.MySqlClient.MySqlException (0x80004005): Duplicate entry '2014-12-19-2434-202-104' for key 'PRIMARY'
   en MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   en MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.GetResult(Int32 statementId, Int32& affectedRows, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   en MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery()
   en VENPRO.cldatos.insert_archivoimport_Mysql(MySqlConnection cnMysql_BD, String fecha_venpro, Int64 codtienda_venpro, String archivo_venpro, Int64 codtabla, String nomtabla, String modoactualizacion, Int32 colposicionupdate, Int32 colposicionupdate1, Int32 colposicionupdate2, Int32 colposicionupdate3, Int32 colposicionupdate4, Int32 colposicionupdate5, Int32 colposicionupdate6, Int32 colposicionupdate7, DataRow[] rwcolumnas, List`1 v_columnaxFila, List`1 v_valorxFila) en E:\VENPRO\VENPRO\cldatos.cs:línea 5513
2015-10-07 0:22:40 : procesarxml().Se elimino Archivo.[E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A449.XML] 
2015-10-07 0:22:40 : Error import_archivo.MoveOld(). No se pudo mover  ORIGEN:[E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A449.XML].DESTINO:[E:\VENPRO\VENPRO\bin\Debug\import\104\old\TRPER20141219A449.XML] System.IO.FileNotFoundException: No se pudo encontrar el archivo 'E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A449.XML'.
Nombre de archivo: 'E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A449.XML'
   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   en System.IO.File.Move(String sourceFileName, String destFileName)
   en VENPRO.Form1.import_archivo(String fecha_venpro, Int64 codtienda, String ruta) en E:\VENPRO\VENPRO\Form1.cs:línea 1643
2015-10-07 0:22:40 : Error.delete_archivoimport_mysql().[delete from signon where fecha_venpro='2015-10-07' and codtienda_venpro=104 and archivo_venpro='TRPER20141219A450.XML' ;]. System.InvalidOperationException: Nested transactions are not supported.
   en MySql.Data.MySqlClient.ExceptionInterceptor.Throw(Exception exception)
   en MySql.Data.MySqlClient.MySqlConnection.Throw(Exception ex)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction(IsolationLevel iso)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction()
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 4968
2015-10-07 0:22:40 : Error.delete_archivoimport_mysql(). System.NullReferenceException: Referencia a objeto no establecida como instancia de un objeto.
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 5010
2015-10-07 0:22:40 : Error. No se logro importar import_archivo(). [E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A447.XML]
2015-10-07 0:22:40 : Error. No se logro importar import_archivo(). [E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A450.XML]
2015-10-07 0:22:48 : Error.insert_RPE_archivoimport_mysql(). Error en la sentencia. [codtabla: {2} - nomtabla: {frame}
ValorFILA: [33], [1], [0], [0], [1099], [0], [0], [1099], [2014-12-19], [08:08:38], [0], [0], [0], [0], [0], [41406], [6547], [11], [0103], []
]Archivo:[TRPER20141219A448.XML]
Fecha: [2015-10-07]
tienda: [103]
[INSERT INTO frame ( archivo_venpro,fecha_venpro, codtienda_venpro, Tr_Frame, StartofTicket, TenderPurchase, PostVoid, TicketNumber, VoidTicketNumber, NoSale, Tail_NumTicketSL, Tail_Fecha, Tail_Hora, Tail_Devolucion, Tail_Training, Tail_Offline, Tail_TicketCancelado, Tail_BadRec, Sequence_ID, Tail_NumCajero, Tail_NumPOS, StoreNumber, TailSeqHighByte ) 
                                    values ( 'TRPER20141219A448.XML' , '2015-10-07' ,103, @Tr_Frame, @StartofTicket, @TenderPurchase, @PostVoid, @TicketNumber, @VoidTicketNumber, @NoSale, @Tail_NumTicketSL, @Tail_Fecha, @Tail_Hora, @Tail_Devolucion, @Tail_Training, @Tail_Offline, @Tail_TicketCancelado, @Tail_BadRec, @Sequence_ID, @Tail_NumCajero, @Tail_NumPOS, @StoreNumber, @TailSeqHighByte )] . MySql.Data.MySqlClient.MySqlException (0x80004005): Duplicate entry '2014-12-19-41406-11-103' for key 'PRIMARY'
   en MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   en MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.GetResult(Int32 statementId, Int32& affectedRows, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   en MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery()
   en VENPRO.cldatos.insert_archivoimport_Mysql(MySqlConnection cnMysql_BD, String fecha_venpro, Int64 codtienda_venpro, String archivo_venpro, Int64 codtabla, String nomtabla, String modoactualizacion, Int32 colposicionupdate, Int32 colposicionupdate1, Int32 colposicionupdate2, Int32 colposicionupdate3, Int32 colposicionupdate4, Int32 colposicionupdate5, Int32 colposicionupdate6, Int32 colposicionupdate7, DataRow[] rwcolumnas, List`1 v_columnaxFila, List`1 v_valorxFila) en E:\VENPRO\VENPRO\cldatos.cs:línea 5513
2015-10-07 0:22:48 : procesarxml().Se elimino Archivo.[E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A448.XML] 
2015-10-07 0:22:48 : Error.insert_RPE_archivoimport_mysql(). Error en la sentencia. [codtabla: {33} - nomtabla: {signon}
ValorFILA: [32], [11], [1412], [1608], [2014-12-19], [08:01:48], [0], [0], [0], [0], [0], [61015], [6203], [176], [0104], []
]Archivo:[TRPER20141219A451.XML]
Fecha: [2015-10-07]
tienda: [104]
[INSERT INTO signon ( archivo_venpro,fecha_venpro, codtienda_venpro, Tr_Log, Log_SignOn, ClaveCajero, Tail_NumTicketSL, Tail_Fecha, Tail_Hora, Tail_Devolucion, Tail_Training, Tail_Offline, Tail_TicketCancelado, Tail_BadRec, Sequence_ID, Tail_NumCajero, Tail_NumPOS, StoreNumber, TailSeqHighByte ) 
                                    values ( 'TRPER20141219A451.XML' , '2015-10-07' ,104, @Tr_Log, @Log_SignOn, @ClaveCajero, @Tail_NumTicketSL, @Tail_Fecha, @Tail_Hora, @Tail_Devolucion, @Tail_Training, @Tail_Offline, @Tail_TicketCancelado, @Tail_BadRec, @Sequence_ID, @Tail_NumCajero, @Tail_NumPOS, @StoreNumber, @TailSeqHighByte )] . MySql.Data.MySqlClient.MySqlException (0x80004005): Duplicate entry '2014-12-19-61015-176-104' for key 'PRIMARY'
   en MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   en MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.GetResult(Int32 statementId, Int32& affectedRows, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   en MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery()
   en VENPRO.cldatos.insert_archivoimport_Mysql(MySqlConnection cnMysql_BD, String fecha_venpro, Int64 codtienda_venpro, String archivo_venpro, Int64 codtabla, String nomtabla, String modoactualizacion, Int32 colposicionupdate, Int32 colposicionupdate1, Int32 colposicionupdate2, Int32 colposicionupdate3, Int32 colposicionupdate4, Int32 colposicionupdate5, Int32 colposicionupdate6, Int32 colposicionupdate7, DataRow[] rwcolumnas, List`1 v_columnaxFila, List`1 v_valorxFila) en E:\VENPRO\VENPRO\cldatos.cs:línea 5513
2015-10-07 0:22:48 : procesarxml().Se elimino Archivo.[E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A451.XML] 
2015-10-07 0:22:55 : Error import_archivo.MoveOld(). No se pudo mover  ORIGEN:[E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A448.XML].DESTINO:[E:\VENPRO\VENPRO\bin\Debug\import\103\old\TRPER20141219A448.XML] System.IO.FileNotFoundException: No se pudo encontrar el archivo 'E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A448.XML'.
Nombre de archivo: 'E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A448.XML'
   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   en System.IO.File.Move(String sourceFileName, String destFileName)
   en VENPRO.Form1.import_archivo(String fecha_venpro, Int64 codtienda, String ruta) en E:\VENPRO\VENPRO\Form1.cs:línea 1643
2015-10-07 0:23:0 : Error.delete_archivoimport_mysql().[delete from frame where fecha_venpro='2015-10-07' and codtienda_venpro=103 and archivo_venpro='TRPER20141219A449.XML' ;]. System.InvalidOperationException: Nested transactions are not supported.
   en MySql.Data.MySqlClient.ExceptionInterceptor.Throw(Exception exception)
   en MySql.Data.MySqlClient.MySqlConnection.Throw(Exception ex)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction(IsolationLevel iso)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction()
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 4968
2015-10-07 0:23:0 : Error import_archivo.MoveOld(). No se pudo mover  ORIGEN:[E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A451.XML].DESTINO:[E:\VENPRO\VENPRO\bin\Debug\import\104\old\TRPER20141219A451.XML] System.IO.FileNotFoundException: No se pudo encontrar el archivo 'E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A451.XML'.
Nombre de archivo: 'E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A451.XML'
   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   en System.IO.File.Move(String sourceFileName, String destFileName)
   en VENPRO.Form1.import_archivo(String fecha_venpro, Int64 codtienda, String ruta) en E:\VENPRO\VENPRO\Form1.cs:línea 1643
2015-10-07 0:23:1 : Error.delete_archivoimport_mysql().[delete from _q_length where fecha_venpro='2015-10-07' and codtienda_venpro=118 and archivo_venpro='TRPER20141009A1151.XML' ;]. System.InvalidOperationException: Nested transactions are not supported.
   en MySql.Data.MySqlClient.ExceptionInterceptor.Throw(Exception exception)
   en MySql.Data.MySqlClient.MySqlConnection.Throw(Exception ex)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction(IsolationLevel iso)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction()
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 4968
2015-10-07 0:23:1 : Error.delete_archivoimport_mysql(). System.NullReferenceException: Referencia a objeto no establecida como instancia de un objeto.
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 5010
2015-10-07 0:23:5 : Error.insert_RPE_archivoimport_mysql(). Error en la sentencia. [codtabla: {2} - nomtabla: {frame}
ValorFILA: [33], [1], [0], [0], [3051], [0], [0], [3051], [2014-11-10], [17:10:37], [0], [0], [0], [0], [0], [39545], [5971], [5], [0123], [4]
]Archivo:[TRPER20141110A1000.XML]
Fecha: [2015-10-07]
tienda: [123]
[INSERT INTO frame ( archivo_venpro,fecha_venpro, codtienda_venpro, Tr_Frame, StartofTicket, TenderPurchase, PostVoid, TicketNumber, VoidTicketNumber, NoSale, Tail_NumTicketSL, Tail_Fecha, Tail_Hora, Tail_Devolucion, Tail_Training, Tail_Offline, Tail_TicketCancelado, Tail_BadRec, Sequence_ID, Tail_NumCajero, Tail_NumPOS, StoreNumber, TailSeqHighByte ) 
                                    values ( 'TRPER20141110A1000.XML' , '2015-10-07' ,123, @Tr_Frame, @StartofTicket, @TenderPurchase, @PostVoid, @TicketNumber, @VoidTicketNumber, @NoSale, @Tail_NumTicketSL, @Tail_Fecha, @Tail_Hora, @Tail_Devolucion, @Tail_Training, @Tail_Offline, @Tail_TicketCancelado, @Tail_BadRec, @Sequence_ID, @Tail_NumCajero, @Tail_NumPOS, @StoreNumber, @TailSeqHighByte )] . MySql.Data.MySqlClient.MySqlException (0x80004005): Duplicate entry '2014-11-10-39545-5-123' for key 'PRIMARY'
   en MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   en MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.GetResult(Int32 statementId, Int32& affectedRows, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   en MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery()
   en VENPRO.cldatos.insert_archivoimport_Mysql(MySqlConnection cnMysql_BD, String fecha_venpro, Int64 codtienda_venpro, String archivo_venpro, Int64 codtabla, String nomtabla, String modoactualizacion, Int32 colposicionupdate, Int32 colposicionupdate1, Int32 colposicionupdate2, Int32 colposicionupdate3, Int32 colposicionupdate4, Int32 colposicionupdate5, Int32 colposicionupdate6, Int32 colposicionupdate7, DataRow[] rwcolumnas, List`1 v_columnaxFila, List`1 v_valorxFila) en E:\VENPRO\VENPRO\cldatos.cs:línea 5513
2015-10-07 0:23:5 : procesarxml().Se elimino Archivo.[E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1000.XML] 
2015-10-07 0:23:5 : Error.delete_archivoimport_mysql(). System.NullReferenceException: Referencia a objeto no establecida como instancia de un objeto.
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 5010
2015-10-07 0:23:5 : Error. No se logro importar import_archivo(). [E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A449.XML]
2015-10-07 0:23:11 : Error import_archivo.MoveOld(). No se pudo mover  ORIGEN:[E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1000.XML].DESTINO:[E:\VENPRO\VENPRO\bin\Debug\import\123\old\TRPER20141110A1000.XML] System.IO.FileNotFoundException: No se pudo encontrar el archivo 'E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1000.XML'.
Nombre de archivo: 'E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1000.XML'
   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   en System.IO.File.Move(String sourceFileName, String destFileName)
   en VENPRO.Form1.import_archivo(String fecha_venpro, Int64 codtienda, String ruta) en E:\VENPRO\VENPRO\Form1.cs:línea 1643
2015-10-07 0:23:25 : Error.delete_archivoimport_mysql().[delete from frame where fecha_venpro='2015-10-07' and codtienda_venpro=103 and archivo_venpro='TRPER20141219A456.XML' ;]. System.InvalidOperationException: Nested transactions are not supported.
   en MySql.Data.MySqlClient.ExceptionInterceptor.Throw(Exception exception)
   en MySql.Data.MySqlClient.MySqlConnection.Throw(Exception ex)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction(IsolationLevel iso)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction()
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 4968
2015-10-07 0:23:28 : Error.delete_archivoimport_mysql(). System.NullReferenceException: Referencia a objeto no establecida como instancia de un objeto.
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 5010
2015-10-07 0:23:31 : Error. No se logro importar import_archivo(). [E:\VENPRO\VENPRO\bin\Debug\import\118\tmp\TRPER20141009A1151.XML]
2015-10-07 0:23:33 : Error.insert_RPE_archivoimport_mysql(). Error en la sentencia. [codtabla: {56} - nomtabla: {CashierFunction}
ValorFILA: [128], [22], [14], [08594103], [3933], [2014-11-10], [17:12:38], [0], [0], [0], [0], [0], [31707], [8683], [7], [0123], [7]
]Archivo:[TRPER20141110A1001.XML]
Fecha: [2015-10-07]
tienda: [123]
[INSERT INTO CashierFunction ( archivo_venpro,fecha_venpro, codtienda_venpro, Trans_Info3, Trans_Info3_cashier_Function, FunctionType, CashierID, Tail_NumTicketSL, Tail_Fecha, Tail_Hora, Tail_Devolucion, Tail_Training, Tail_Offline, Tail_TicketCancelado, Tail_BadRec, Sequence_ID, Tail_NumCajero, Tail_NumPOS, StoreNumber, TailSeqHighByte ) 
                                    values ( 'TRPER20141110A1001.XML' , '2015-10-07' ,123, @Trans_Info3, @Trans_Info3_cashier_Function, @FunctionType, @CashierID, @Tail_NumTicketSL, @Tail_Fecha, @Tail_Hora, @Tail_Devolucion, @Tail_Training, @Tail_Offline, @Tail_TicketCancelado, @Tail_BadRec, @Sequence_ID, @Tail_NumCajero, @Tail_NumPOS, @StoreNumber, @TailSeqHighByte )] . MySql.Data.MySqlClient.MySqlException (0x80004005): Duplicate entry '2014-11-10-31707-7-123' for key 'PRIMARY'
   en MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   en MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.GetResult(Int32 statementId, Int32& affectedRows, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   en MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery()
   en VENPRO.cldatos.insert_archivoimport_Mysql(MySqlConnection cnMysql_BD, String fecha_venpro, Int64 codtienda_venpro, String archivo_venpro, Int64 codtabla, String nomtabla, String modoactualizacion, Int32 colposicionupdate, Int32 colposicionupdate1, Int32 colposicionupdate2, Int32 colposicionupdate3, Int32 colposicionupdate4, Int32 colposicionupdate5, Int32 colposicionupdate6, Int32 colposicionupdate7, DataRow[] rwcolumnas, List`1 v_columnaxFila, List`1 v_valorxFila) en E:\VENPRO\VENPRO\cldatos.cs:línea 5513
2015-10-07 0:23:33 : procesarxml().Se elimino Archivo.[E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1001.XML] 
2015-10-07 0:23:33 : Error. No se logro importar import_archivo(). [E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A456.XML]
2015-10-07 0:23:33 : Error.insert_RPE_archivoimport_mysql(). Error en la sentencia. [codtabla: {2} - nomtabla: {frame}
ValorFILA: [33], [1], [0], [0], [108], [0], [0], [108], [2014-12-19], [07:27:34], [0], [0], [0], [1], [0], [26286], [1355], [186], [0104], []
]Archivo:[TRPER20141219A452.XML]
Fecha: [2015-10-07]
tienda: [104]
[INSERT INTO frame ( archivo_venpro,fecha_venpro, codtienda_venpro, Tr_Frame, StartofTicket, TenderPurchase, PostVoid, TicketNumber, VoidTicketNumber, NoSale, Tail_NumTicketSL, Tail_Fecha, Tail_Hora, Tail_Devolucion, Tail_Training, Tail_Offline, Tail_TicketCancelado, Tail_BadRec, Sequence_ID, Tail_NumCajero, Tail_NumPOS, StoreNumber, TailSeqHighByte ) 
                                    values ( 'TRPER20141219A452.XML' , '2015-10-07' ,104, @Tr_Frame, @StartofTicket, @TenderPurchase, @PostVoid, @TicketNumber, @VoidTicketNumber, @NoSale, @Tail_NumTicketSL, @Tail_Fecha, @Tail_Hora, @Tail_Devolucion, @Tail_Training, @Tail_Offline, @Tail_TicketCancelado, @Tail_BadRec, @Sequence_ID, @Tail_NumCajero, @Tail_NumPOS, @StoreNumber, @TailSeqHighByte )] . MySql.Data.MySqlClient.MySqlException (0x80004005): Duplicate entry '2014-12-19-26286-186-104' for key 'PRIMARY'
   en MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   en MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.GetResult(Int32 statementId, Int32& affectedRows, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   en MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery()
   en VENPRO.cldatos.insert_archivoimport_Mysql(MySqlConnection cnMysql_BD, String fecha_venpro, Int64 codtienda_venpro, String archivo_venpro, Int64 codtabla, String nomtabla, String modoactualizacion, Int32 colposicionupdate, Int32 colposicionupdate1, Int32 colposicionupdate2, Int32 colposicionupdate3, Int32 colposicionupdate4, Int32 colposicionupdate5, Int32 colposicionupdate6, Int32 colposicionupdate7, DataRow[] rwcolumnas, List`1 v_columnaxFila, List`1 v_valorxFila) en E:\VENPRO\VENPRO\cldatos.cs:línea 5513
2015-10-07 0:23:33 : procesarxml().Se elimino Archivo.[E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A452.XML] 
2015-10-07 0:23:39 : Error import_archivo.MoveOld(). No se pudo mover  ORIGEN:[E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1001.XML].DESTINO:[E:\VENPRO\VENPRO\bin\Debug\import\123\old\TRPER20141110A1001.XML] System.IO.FileNotFoundException: No se pudo encontrar el archivo 'E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1001.XML'.
Nombre de archivo: 'E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1001.XML'
   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   en System.IO.File.Move(String sourceFileName, String destFileName)
   en VENPRO.Form1.import_archivo(String fecha_venpro, Int64 codtienda, String ruta) en E:\VENPRO\VENPRO\Form1.cs:línea 1643
2015-10-07 0:23:40 : Error.delete_archivoimport_mysql().[delete from frame where fecha_venpro='2015-10-07' and codtienda_venpro=103 and archivo_venpro='TRPER20141219A457.XML' ;]. System.InvalidOperationException: Nested transactions are not supported.
   en MySql.Data.MySqlClient.ExceptionInterceptor.Throw(Exception exception)
   en MySql.Data.MySqlClient.MySqlConnection.Throw(Exception ex)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction(IsolationLevel iso)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction()
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 4968
2015-10-07 0:23:40 : Error import_archivo.MoveOld(). No se pudo mover  ORIGEN:[E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A452.XML].DESTINO:[E:\VENPRO\VENPRO\bin\Debug\import\104\old\TRPER20141219A452.XML] System.IO.FileNotFoundException: No se pudo encontrar el archivo 'E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A452.XML'.
Nombre de archivo: 'E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A452.XML'
   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   en System.IO.File.Move(String sourceFileName, String destFileName)
   en VENPRO.Form1.import_archivo(String fecha_venpro, Int64 codtienda, String ruta) en E:\VENPRO\VENPRO\Form1.cs:línea 1643
2015-10-07 0:23:46 : Error.delete_archivoimport_mysql(). System.NullReferenceException: Referencia a objeto no establecida como instancia de un objeto.
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 5010
2015-10-07 0:23:46 : Error.delete_archivoimport_mysql().[delete from signon where fecha_venpro='2015-10-07' and codtienda_venpro=104 and archivo_venpro='TRPER20141219A453.XML' ;]. System.InvalidOperationException: Nested transactions are not supported.
   en MySql.Data.MySqlClient.ExceptionInterceptor.Throw(Exception exception)
   en MySql.Data.MySqlClient.MySqlConnection.Throw(Exception ex)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction(IsolationLevel iso)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction()
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 4968
2015-10-07 0:23:48 : Error. No se logro importar import_archivo(). [E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A457.XML]
2015-10-07 0:23:48 : Error.insert_RPE_archivoimport_mysql(). Error en la sentencia. [codtabla: {2} - nomtabla: {frame}
ValorFILA: [33], [1], [0], [0], [1103], [0], [0], [1103], [2014-12-19], [08:18:28], [0], [0], [0], [0], [0], [41640], [6547], [11], [0103], []
]Archivo:[TRPER20141219A462.XML]
Fecha: [2015-10-07]
tienda: [103]
[INSERT INTO frame ( archivo_venpro,fecha_venpro, codtienda_venpro, Tr_Frame, StartofTicket, TenderPurchase, PostVoid, TicketNumber, VoidTicketNumber, NoSale, Tail_NumTicketSL, Tail_Fecha, Tail_Hora, Tail_Devolucion, Tail_Training, Tail_Offline, Tail_TicketCancelado, Tail_BadRec, Sequence_ID, Tail_NumCajero, Tail_NumPOS, StoreNumber, TailSeqHighByte ) 
                                    values ( 'TRPER20141219A462.XML' , '2015-10-07' ,103, @Tr_Frame, @StartofTicket, @TenderPurchase, @PostVoid, @TicketNumber, @VoidTicketNumber, @NoSale, @Tail_NumTicketSL, @Tail_Fecha, @Tail_Hora, @Tail_Devolucion, @Tail_Training, @Tail_Offline, @Tail_TicketCancelado, @Tail_BadRec, @Sequence_ID, @Tail_NumCajero, @Tail_NumPOS, @StoreNumber, @TailSeqHighByte )] . MySql.Data.MySqlClient.MySqlException (0x80004005): Duplicate entry '2014-12-19-41640-11-103' for key 'PRIMARY'
   en MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   en MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.GetResult(Int32 statementId, Int32& affectedRows, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   en MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery()
   en VENPRO.cldatos.insert_archivoimport_Mysql(MySqlConnection cnMysql_BD, String fecha_venpro, Int64 codtienda_venpro, String archivo_venpro, Int64 codtabla, String nomtabla, String modoactualizacion, Int32 colposicionupdate, Int32 colposicionupdate1, Int32 colposicionupdate2, Int32 colposicionupdate3, Int32 colposicionupdate4, Int32 colposicionupdate5, Int32 colposicionupdate6, Int32 colposicionupdate7, DataRow[] rwcolumnas, List`1 v_columnaxFila, List`1 v_valorxFila) en E:\VENPRO\VENPRO\cldatos.cs:línea 5513
2015-10-07 0:23:48 : procesarxml().Se elimino Archivo.[E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A462.XML] 
2015-10-07 0:23:48 : Error import_archivo.MoveOld(). No se pudo mover  ORIGEN:[E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A462.XML].DESTINO:[E:\VENPRO\VENPRO\bin\Debug\import\103\old\TRPER20141219A462.XML] System.IO.FileNotFoundException: No se pudo encontrar el archivo 'E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A462.XML'.
Nombre de archivo: 'E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A462.XML'
   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   en System.IO.File.Move(String sourceFileName, String destFileName)
   en VENPRO.Form1.import_archivo(String fecha_venpro, Int64 codtienda, String ruta) en E:\VENPRO\VENPRO\Form1.cs:línea 1643
2015-10-07 0:23:48 : Error.delete_archivoimport_mysql(). System.NullReferenceException: Referencia a objeto no establecida como instancia de un objeto.
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 5010
2015-10-07 0:23:53 : Error.insert_RPE_archivoimport_mysql(). Error en la sentencia. [codtabla: {2} - nomtabla: {frame}
ValorFILA: [33], [1], [0], [0], [3053], [0], [0], [3053], [2014-11-10], [17:12:15], [0], [0], [0], [0], [0], [39635], [5971], [5], [0123], [4]
]Archivo:[TRPER20141110A1002.XML]
Fecha: [2015-10-07]
tienda: [123]
[INSERT INTO frame ( archivo_venpro,fecha_venpro, codtienda_venpro, Tr_Frame, StartofTicket, TenderPurchase, PostVoid, TicketNumber, VoidTicketNumber, NoSale, Tail_NumTicketSL, Tail_Fecha, Tail_Hora, Tail_Devolucion, Tail_Training, Tail_Offline, Tail_TicketCancelado, Tail_BadRec, Sequence_ID, Tail_NumCajero, Tail_NumPOS, StoreNumber, TailSeqHighByte ) 
                                    values ( 'TRPER20141110A1002.XML' , '2015-10-07' ,123, @Tr_Frame, @StartofTicket, @TenderPurchase, @PostVoid, @TicketNumber, @VoidTicketNumber, @NoSale, @Tail_NumTicketSL, @Tail_Fecha, @Tail_Hora, @Tail_Devolucion, @Tail_Training, @Tail_Offline, @Tail_TicketCancelado, @Tail_BadRec, @Sequence_ID, @Tail_NumCajero, @Tail_NumPOS, @StoreNumber, @TailSeqHighByte )] . MySql.Data.MySqlClient.MySqlException (0x80004005): Duplicate entry '2014-11-10-39635-5-123' for key 'PRIMARY'
   en MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   en MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.GetResult(Int32 statementId, Int32& affectedRows, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   en MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery()
   en VENPRO.cldatos.insert_archivoimport_Mysql(MySqlConnection cnMysql_BD, String fecha_venpro, Int64 codtienda_venpro, String archivo_venpro, Int64 codtabla, String nomtabla, String modoactualizacion, Int32 colposicionupdate, Int32 colposicionupdate1, Int32 colposicionupdate2, Int32 colposicionupdate3, Int32 colposicionupdate4, Int32 colposicionupdate5, Int32 colposicionupdate6, Int32 colposicionupdate7, DataRow[] rwcolumnas, List`1 v_columnaxFila, List`1 v_valorxFila) en E:\VENPRO\VENPRO\cldatos.cs:línea 5513
2015-10-07 0:23:53 : procesarxml().Se elimino Archivo.[E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1002.XML] 
2015-10-07 0:23:59 : Error procesarxml(). [E:\VENPRO\VENPRO\bin\Debug\import\1041\tmp][E:\VENPRO\VENPRO\bin\Debug\import\1041\tmp\TRPER20141009A671.XML] [tag1: 
tag2: 
tag3_tabla: 
tag4_columna: 
tag4_columna_valor: 
MySql.Data.MySqlClient.MySqlException (0x80004005): Authentication to host 'localhost' for user 'root' using method 'mysql_native_password' failed with message: Reading from the stream has failed. ---> MySql.Data.MySqlClient.MySqlException (0x80004005): Reading from the stream has failed. ---> System.IO.IOException: No se puede escribir datos de en la conexión de transporte: Se ha anulado una conexión establecida por el software en su equipo host. ---> System.Net.Sockets.SocketException: Se ha anulado una conexión establecida por el software en su equipo host
   en System.Net.Sockets.Socket.Receive(Byte[] buffer, Int32 offset, Int32 size, SocketFlags socketFlags)
   en System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset, Int32 size)
   --- Fin del seguimiento de la pila de la excepción interna ---
   en MySql.Data.Common.MyNetworkStream.HandleOrRethrowException(Exception e)
   en MySql.Data.Common.MyNetworkStream.Read(Byte[] buffer, Int32 offset, Int32 count)
   en MySql.Data.MySqlClient.TimedStream.Read(Byte[] buffer, Int32 offset, Int32 count)
   en System.IO.BufferedStream.Read(Byte[] array, Int32 offset, Int32 count)
   en MySql.Data.MySqlClient.MySqlStream.ReadFully(Stream stream, Byte[] buffer, Int32 offset, Int32 count)
   en MySql.Data.MySqlClient.MySqlStream.LoadPacket()
   en MySql.Data.MySqlClient.MySqlStream.LoadPacket()
   en MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   en MySql.Data.MySqlClient.NativeDriver.ReadPacket()
   en MySql.Data.MySqlClient.Authentication.MySqlAuthenticationPlugin.ReadPacket()
   en MySql.Data.MySqlClient.Authentication.MySqlAuthenticationPlugin.AuthenticationFailed(Exception ex)
   en MySql.Data.MySqlClient.Authentication.MySqlAuthenticationPlugin.ReadPacket()
   en MySql.Data.MySqlClient.Authentication.MySqlAuthenticationPlugin.Authenticate(Boolean reset)
   en MySql.Data.MySqlClient.NativeDriver.Authenticate(String authMethod, Boolean reset)
   en MySql.Data.MySqlClient.NativeDriver.Open()
   en MySql.Data.MySqlClient.Driver.Open()
   en MySql.Data.MySqlClient.Driver.Create(MySqlConnectionStringBuilder settings)
   en MySql.Data.MySqlClient.MySqlPool.CreateNewPooledConnection()
   en MySql.Data.MySqlClient.MySqlPool.GetPooledConnection()
   en MySql.Data.MySqlClient.MySqlPool.TryToGetDriver()
   en MySql.Data.MySqlClient.MySqlPool.GetConnection()
   en MySql.Data.MySqlClient.MySqlConnection.Open()
   en VENPRO.Form1.procesarxml(String fecha_venpro, Int64 codtienda, String ruta, String arch) en E:\VENPRO\VENPRO\Form1.cs:línea 806
2015-10-07 0:23:59 : Error. No se logro importar import_archivo(). [E:\VENPRO\VENPRO\bin\Debug\import\1041\tmp\TRPER20141009A671.XML]
2015-10-07 0:24:0 : Error import_archivo.MoveOld(). No se pudo mover  ORIGEN:[E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1002.XML].DESTINO:[E:\VENPRO\VENPRO\bin\Debug\import\123\old\TRPER20141110A1002.XML] System.IO.FileNotFoundException: No se pudo encontrar el archivo 'E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1002.XML'.
Nombre de archivo: 'E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1002.XML'
   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   en System.IO.File.Move(String sourceFileName, String destFileName)
   en VENPRO.Form1.import_archivo(String fecha_venpro, Int64 codtienda, String ruta) en E:\VENPRO\VENPRO\Form1.cs:línea 1643
2015-10-07 0:24:5 : Error.delete_archivoimport_mysql().[delete from frame where fecha_venpro='2015-10-07' and codtienda_venpro=107 and archivo_venpro='TRPER20141009A1178.XML' ;]. System.InvalidOperationException: Nested transactions are not supported.
   en MySql.Data.MySqlClient.ExceptionInterceptor.Throw(Exception exception)
   en MySql.Data.MySqlClient.MySqlConnection.Throw(Exception ex)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction(IsolationLevel iso)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction()
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 4968
2015-10-07 0:24:13 : Error.delete_archivoimport_mysql(). System.NullReferenceException: Referencia a objeto no establecida como instancia de un objeto.
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 5010
2015-10-07 0:24:13 : Error.delete_archivoimport_mysql().[delete from frame where fecha_venpro='2015-10-07' and codtienda_venpro=123 and archivo_venpro='TRPER20141110A1003.XML' ;]. System.InvalidOperationException: Nested transactions are not supported.
   en MySql.Data.MySqlClient.ExceptionInterceptor.Throw(Exception exception)
   en MySql.Data.MySqlClient.MySqlConnection.Throw(Exception ex)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction(IsolationLevel iso)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction()
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 4968
2015-10-07 0:24:13 : Error.insert_RPE_archivoimport_mysql(). Error en la sentencia. [codtabla: {28} - nomtabla: {_q_length}
ValorFILA: [96], [55], [2], [2697], [2014-12-19], [08:23:36], [0], [0], [0], [0], [0], [25102], [2180], [13], [0103], []
]Archivo:[TRPER20141219A463.XML]
Fecha: [2015-10-07]
tienda: [103]
[INSERT INTO _q_length ( archivo_venpro,fecha_venpro, codtienda_venpro, Info, _Info_Q_Length, _Q_Length, Tail_NumTicketSL, Tail_Fecha, Tail_Hora, Tail_Devolucion, Tail_Training, Tail_Offline, Tail_TicketCancelado, Tail_BadRec, Sequence_ID, Tail_NumCajero, Tail_NumPOS, StoreNumber, TailSeqHighByte ) 
                                    values ( 'TRPER20141219A463.XML' , '2015-10-07' ,103, @Info, @_Info_Q_Length, @_Q_Length, @Tail_NumTicketSL, @Tail_Fecha, @Tail_Hora, @Tail_Devolucion, @Tail_Training, @Tail_Offline, @Tail_TicketCancelado, @Tail_BadRec, @Sequence_ID, @Tail_NumCajero, @Tail_NumPOS, @StoreNumber, @TailSeqHighByte )] . MySql.Data.MySqlClient.MySqlException (0x80004005): Duplicate entry '2014-12-19-25102-13-103' for key 'PRIMARY'
   en MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   en MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.GetResult(Int32 statementId, Int32& affectedRows, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   en MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery()
   en VENPRO.cldatos.insert_archivoimport_Mysql(MySqlConnection cnMysql_BD, String fecha_venpro, Int64 codtienda_venpro, String archivo_venpro, Int64 codtabla, String nomtabla, String modoactualizacion, Int32 colposicionupdate, Int32 colposicionupdate1, Int32 colposicionupdate2, Int32 colposicionupdate3, Int32 colposicionupdate4, Int32 colposicionupdate5, Int32 colposicionupdate6, Int32 colposicionupdate7, DataRow[] rwcolumnas, List`1 v_columnaxFila, List`1 v_valorxFila) en E:\VENPRO\VENPRO\cldatos.cs:línea 5513
2015-10-07 0:24:13 : procesarxml().Se elimino Archivo.[E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A463.XML] 
2015-10-07 0:24:15 : Error.delete_archivoimport_mysql(). System.NullReferenceException: Referencia a objeto no establecida como instancia de un objeto.
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 5010
2015-10-07 0:24:15 : Error. No se logro importar import_archivo(). [E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A453.XML]
2015-10-07 0:24:21 : Error. No se logro importar import_archivo(). [E:\VENPRO\VENPRO\bin\Debug\import\107\tmp\TRPER20141009A1178.XML]
2015-10-07 0:24:22 : Error. No se logro importar import_archivo(). [E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1003.XML]
2015-10-07 0:24:27 : Error import_archivo.MoveOld(). No se pudo mover  ORIGEN:[E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A463.XML].DESTINO:[E:\VENPRO\VENPRO\bin\Debug\import\103\old\TRPER20141219A463.XML] System.IO.FileNotFoundException: No se pudo encontrar el archivo 'E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A463.XML'.
Nombre de archivo: 'E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A463.XML'
   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   en System.IO.File.Move(String sourceFileName, String destFileName)
   en VENPRO.Form1.import_archivo(String fecha_venpro, Int64 codtienda, String ruta) en E:\VENPRO\VENPRO\Form1.cs:línea 1643
2015-10-07 0:24:29 : Error.delete_archivoimport_mysql().[delete from signon where fecha_venpro='2015-10-07' and codtienda_venpro=104 and archivo_venpro='TRPER20141219A454.XML' ;]. System.InvalidOperationException: Nested transactions are not supported.
   en MySql.Data.MySqlClient.ExceptionInterceptor.Throw(Exception exception)
   en MySql.Data.MySqlClient.MySqlConnection.Throw(Exception ex)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction(IsolationLevel iso)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction()
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 4968
2015-10-07 0:24:34 : Error.insert_RPE_archivoimport_mysql(). Error en la sentencia. [codtabla: {2} - nomtabla: {frame}
ValorFILA: [33], [1], [0], [1], [3055], [0], [0], [3055], [2014-11-10], [17:15:34], [0], [0], [0], [1], [0], [39772], [5971], [5], [0123], [4]
]Archivo:[TRPER20141110A1004.XML]
Fecha: [2015-10-07]
tienda: [123]
[INSERT INTO frame ( archivo_venpro,fecha_venpro, codtienda_venpro, Tr_Frame, StartofTicket, TenderPurchase, PostVoid, TicketNumber, VoidTicketNumber, NoSale, Tail_NumTicketSL, Tail_Fecha, Tail_Hora, Tail_Devolucion, Tail_Training, Tail_Offline, Tail_TicketCancelado, Tail_BadRec, Sequence_ID, Tail_NumCajero, Tail_NumPOS, StoreNumber, TailSeqHighByte ) 
                                    values ( 'TRPER20141110A1004.XML' , '2015-10-07' ,123, @Tr_Frame, @StartofTicket, @TenderPurchase, @PostVoid, @TicketNumber, @VoidTicketNumber, @NoSale, @Tail_NumTicketSL, @Tail_Fecha, @Tail_Hora, @Tail_Devolucion, @Tail_Training, @Tail_Offline, @Tail_TicketCancelado, @Tail_BadRec, @Sequence_ID, @Tail_NumCajero, @Tail_NumPOS, @StoreNumber, @TailSeqHighByte )] . MySql.Data.MySqlClient.MySqlException (0x80004005): Duplicate entry '2014-11-10-39772-5-123' for key 'PRIMARY'
   en MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   en MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.GetResult(Int32 statementId, Int32& affectedRows, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   en MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery()
   en VENPRO.cldatos.insert_archivoimport_Mysql(MySqlConnection cnMysql_BD, String fecha_venpro, Int64 codtienda_venpro, String archivo_venpro, Int64 codtabla, String nomtabla, String modoactualizacion, Int32 colposicionupdate, Int32 colposicionupdate1, Int32 colposicionupdate2, Int32 colposicionupdate3, Int32 colposicionupdate4, Int32 colposicionupdate5, Int32 colposicionupdate6, Int32 colposicionupdate7, DataRow[] rwcolumnas, List`1 v_columnaxFila, List`1 v_valorxFila) en E:\VENPRO\VENPRO\cldatos.cs:línea 5513
2015-10-07 0:24:34 : procesarxml().Se elimino Archivo.[E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1004.XML] 
2015-10-07 0:24:34 : Error.delete_archivoimport_mysql(). System.NullReferenceException: Referencia a objeto no establecida como instancia de un objeto.
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 5010
2015-10-07 0:24:40 : Error import_archivo.MoveOld(). No se pudo mover  ORIGEN:[E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1004.XML].DESTINO:[E:\VENPRO\VENPRO\bin\Debug\import\123\old\TRPER20141110A1004.XML] System.IO.FileNotFoundException: No se pudo encontrar el archivo 'E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1004.XML'.
Nombre de archivo: 'E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1004.XML'
   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   en System.IO.File.Move(String sourceFileName, String destFileName)
   en VENPRO.Form1.import_archivo(String fecha_venpro, Int64 codtienda, String ruta) en E:\VENPRO\VENPRO\Form1.cs:línea 1643
2015-10-07 0:24:55 : Error.delete_archivoimport_mysql().[delete from trans_info2_measuring_bb_time where fecha_venpro='2015-10-07' and codtienda_venpro=123 and archivo_venpro='TRPER20141110A1014.XML' ;]. System.InvalidOperationException: Nested transactions are not supported.
   en MySql.Data.MySqlClient.ExceptionInterceptor.Throw(Exception exception)
   en MySql.Data.MySqlClient.MySqlConnection.Throw(Exception ex)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction(IsolationLevel iso)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction()
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 4968
2015-10-07 0:24:55 : Error.insert_RPE_archivoimport_mysql(). Error en la sentencia. [codtabla: {2} - nomtabla: {frame}
ValorFILA: [33], [1], [0], [0], [2698], [0], [0], [2698], [2014-12-19], [08:26:34], [0], [0], [0], [0], [0], [25129], [2180], [13], [0103], []
]Archivo:[TRPER20141219A466.XML]
Fecha: [2015-10-07]
tienda: [103]
[INSERT INTO frame ( archivo_venpro,fecha_venpro, codtienda_venpro, Tr_Frame, StartofTicket, TenderPurchase, PostVoid, TicketNumber, VoidTicketNumber, NoSale, Tail_NumTicketSL, Tail_Fecha, Tail_Hora, Tail_Devolucion, Tail_Training, Tail_Offline, Tail_TicketCancelado, Tail_BadRec, Sequence_ID, Tail_NumCajero, Tail_NumPOS, StoreNumber, TailSeqHighByte ) 
                                    values ( 'TRPER20141219A466.XML' , '2015-10-07' ,103, @Tr_Frame, @StartofTicket, @TenderPurchase, @PostVoid, @TicketNumber, @VoidTicketNumber, @NoSale, @Tail_NumTicketSL, @Tail_Fecha, @Tail_Hora, @Tail_Devolucion, @Tail_Training, @Tail_Offline, @Tail_TicketCancelado, @Tail_BadRec, @Sequence_ID, @Tail_NumCajero, @Tail_NumPOS, @StoreNumber, @TailSeqHighByte )] . MySql.Data.MySqlClient.MySqlException (0x80004005): Duplicate entry '2014-12-19-25129-13-103' for key 'PRIMARY'
   en MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   en MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.GetResult(Int32 statementId, Int32& affectedRows, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   en MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery()
   en VENPRO.cldatos.insert_archivoimport_Mysql(MySqlConnection cnMysql_BD, String fecha_venpro, Int64 codtienda_venpro, String archivo_venpro, Int64 codtabla, String nomtabla, String modoactualizacion, Int32 colposicionupdate, Int32 colposicionupdate1, Int32 colposicionupdate2, Int32 colposicionupdate3, Int32 colposicionupdate4, Int32 colposicionupdate5, Int32 colposicionupdate6, Int32 colposicionupdate7, DataRow[] rwcolumnas, List`1 v_columnaxFila, List`1 v_valorxFila) en E:\VENPRO\VENPRO\cldatos.cs:línea 5513
2015-10-07 0:24:55 : procesarxml().Se elimino Archivo.[E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A466.XML] 
2015-10-07 0:24:56 : Error.delete_archivoimport_mysql(). System.NullReferenceException: Referencia a objeto no establecida como instancia de un objeto.
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 5010
2015-10-07 0:24:57 : Error. No se logro importar import_archivo(). [E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A454.XML]
2015-10-07 0:24:57 : Error import_archivo.MoveOld(). No se pudo mover  ORIGEN:[E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A466.XML].DESTINO:[E:\VENPRO\VENPRO\bin\Debug\import\103\old\TRPER20141219A466.XML] System.IO.FileNotFoundException: No se pudo encontrar el archivo 'E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A466.XML'.
Nombre de archivo: 'E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A466.XML'
   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   en System.IO.File.Move(String sourceFileName, String destFileName)
   en VENPRO.Form1.import_archivo(String fecha_venpro, Int64 codtienda, String ruta) en E:\VENPRO\VENPRO\Form1.cs:línea 1643
2015-10-07 0:25:1 : Error. No se logro importar import_archivo(). [E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1014.XML]
2015-10-07 0:25:2 : Error.delete_archivoimport_mysql().[delete from frame where fecha_venpro='2015-10-07' and codtienda_venpro=104 and archivo_venpro='TRPER20141219A455.XML' ;]. System.InvalidOperationException: Nested transactions are not supported.
   en MySql.Data.MySqlClient.ExceptionInterceptor.Throw(Exception exception)
   en MySql.Data.MySqlClient.MySqlConnection.Throw(Exception ex)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction(IsolationLevel iso)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction()
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 4968
2015-10-07 0:25:3 : Error.delete_archivoimport_mysql(). System.NullReferenceException: Referencia a objeto no establecida como instancia de un objeto.
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 5010
2015-10-07 0:25:11 : Error.insert_RPE_archivoimport_mysql(). Error en la sentencia. [codtabla: {2} - nomtabla: {frame}
ValorFILA: [33], [1], [0], [0], [2699], [0], [0], [2699], [2014-12-19], [08:27:09], [0], [0], [0], [0], [0], [25168], [2180], [13], [0103], []
]Archivo:[TRPER20141219A467.XML]
Fecha: [2015-10-07]
tienda: [103]
[INSERT INTO frame ( archivo_venpro,fecha_venpro, codtienda_venpro, Tr_Frame, StartofTicket, TenderPurchase, PostVoid, TicketNumber, VoidTicketNumber, NoSale, Tail_NumTicketSL, Tail_Fecha, Tail_Hora, Tail_Devolucion, Tail_Training, Tail_Offline, Tail_TicketCancelado, Tail_BadRec, Sequence_ID, Tail_NumCajero, Tail_NumPOS, StoreNumber, TailSeqHighByte ) 
                                    values ( 'TRPER20141219A467.XML' , '2015-10-07' ,103, @Tr_Frame, @StartofTicket, @TenderPurchase, @PostVoid, @TicketNumber, @VoidTicketNumber, @NoSale, @Tail_NumTicketSL, @Tail_Fecha, @Tail_Hora, @Tail_Devolucion, @Tail_Training, @Tail_Offline, @Tail_TicketCancelado, @Tail_BadRec, @Sequence_ID, @Tail_NumCajero, @Tail_NumPOS, @StoreNumber, @TailSeqHighByte )] . MySql.Data.MySqlClient.MySqlException (0x80004005): Duplicate entry '2014-12-19-25168-13-103' for key 'PRIMARY'
   en MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   en MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.GetResult(Int32 statementId, Int32& affectedRows, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   en MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery()
   en VENPRO.cldatos.insert_archivoimport_Mysql(MySqlConnection cnMysql_BD, String fecha_venpro, Int64 codtienda_venpro, String archivo_venpro, Int64 codtabla, String nomtabla, String modoactualizacion, Int32 colposicionupdate, Int32 colposicionupdate1, Int32 colposicionupdate2, Int32 colposicionupdate3, Int32 colposicionupdate4, Int32 colposicionupdate5, Int32 colposicionupdate6, Int32 colposicionupdate7, DataRow[] rwcolumnas, List`1 v_columnaxFila, List`1 v_valorxFila) en E:\VENPRO\VENPRO\cldatos.cs:línea 5513
2015-10-07 0:25:11 : procesarxml().Se elimino Archivo.[E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A467.XML] 
2015-10-07 0:25:15 : Error.insert_RPE_archivoimport_mysql(). Error en la sentencia. [codtabla: {2} - nomtabla: {frame}
ValorFILA: [33], [1], [0], [0], [5556], [0], [0], [5556], [2014-11-10], [17:26:24], [0], [0], [0], [0], [0], [63866], [4016], [17], [0123], [8]
]Archivo:[TRPER20141110A1016.XML]
Fecha: [2015-10-07]
tienda: [123]
[INSERT INTO frame ( archivo_venpro,fecha_venpro, codtienda_venpro, Tr_Frame, StartofTicket, TenderPurchase, PostVoid, TicketNumber, VoidTicketNumber, NoSale, Tail_NumTicketSL, Tail_Fecha, Tail_Hora, Tail_Devolucion, Tail_Training, Tail_Offline, Tail_TicketCancelado, Tail_BadRec, Sequence_ID, Tail_NumCajero, Tail_NumPOS, StoreNumber, TailSeqHighByte ) 
                                    values ( 'TRPER20141110A1016.XML' , '2015-10-07' ,123, @Tr_Frame, @StartofTicket, @TenderPurchase, @PostVoid, @TicketNumber, @VoidTicketNumber, @NoSale, @Tail_NumTicketSL, @Tail_Fecha, @Tail_Hora, @Tail_Devolucion, @Tail_Training, @Tail_Offline, @Tail_TicketCancelado, @Tail_BadRec, @Sequence_ID, @Tail_NumCajero, @Tail_NumPOS, @StoreNumber, @TailSeqHighByte )] . MySql.Data.MySqlClient.MySqlException (0x80004005): Duplicate entry '2014-11-10-63866-17-123' for key 'PRIMARY'
   en MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   en MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.GetResult(Int32 statementId, Int32& affectedRows, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   en MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery()
   en VENPRO.cldatos.insert_archivoimport_Mysql(MySqlConnection cnMysql_BD, String fecha_venpro, Int64 codtienda_venpro, String archivo_venpro, Int64 codtabla, String nomtabla, String modoactualizacion, Int32 colposicionupdate, Int32 colposicionupdate1, Int32 colposicionupdate2, Int32 colposicionupdate3, Int32 colposicionupdate4, Int32 colposicionupdate5, Int32 colposicionupdate6, Int32 colposicionupdate7, DataRow[] rwcolumnas, List`1 v_columnaxFila, List`1 v_valorxFila) en E:\VENPRO\VENPRO\cldatos.cs:línea 5513
2015-10-07 0:25:15 : procesarxml().Se elimino Archivo.[E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1016.XML] 
2015-10-07 0:25:23 : Error import_archivo.MoveOld(). No se pudo mover  ORIGEN:[E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1016.XML].DESTINO:[E:\VENPRO\VENPRO\bin\Debug\import\123\old\TRPER20141110A1016.XML] System.IO.FileNotFoundException: No se pudo encontrar el archivo 'E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1016.XML'.
Nombre de archivo: 'E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1016.XML'
   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   en System.IO.File.Move(String sourceFileName, String destFileName)
   en VENPRO.Form1.import_archivo(String fecha_venpro, Int64 codtienda, String ruta) en E:\VENPRO\VENPRO\Form1.cs:línea 1643
2015-10-07 0:25:23 : Error. No se logro importar import_archivo(). [E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A455.XML]
2015-10-07 0:25:24 : Error.delete_archivoimport_mysql().[delete from frame where fecha_venpro='2015-10-07' and codtienda_venpro=118 and archivo_venpro='TRPER20141009A1154.XML' ;]. System.InvalidOperationException: Nested transactions are not supported.
   en MySql.Data.MySqlClient.ExceptionInterceptor.Throw(Exception exception)
   en MySql.Data.MySqlClient.MySqlConnection.Throw(Exception ex)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction(IsolationLevel iso)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction()
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 4968
2015-10-07 0:25:24 : Error import_archivo.MoveOld(). No se pudo mover  ORIGEN:[E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A467.XML].DESTINO:[E:\VENPRO\VENPRO\bin\Debug\import\103\old\TRPER20141219A467.XML] System.IO.FileNotFoundException: No se pudo encontrar el archivo 'E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A467.XML'.
Nombre de archivo: 'E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A467.XML'
   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   en System.IO.File.Move(String sourceFileName, String destFileName)
   en VENPRO.Form1.import_archivo(String fecha_venpro, Int64 codtienda, String ruta) en E:\VENPRO\VENPRO\Form1.cs:línea 1643
2015-10-07 0:25:31 : Error.delete_archivoimport_mysql(). System.NullReferenceException: Referencia a objeto no establecida como instancia de un objeto.
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 5010
2015-10-07 0:25:31 : Error. No se logro importar import_archivo(). [E:\VENPRO\VENPRO\bin\Debug\import\118\tmp\TRPER20141009A1154.XML]
2015-10-07 0:25:32 : Error.delete_archivoimport_mysql().[delete from frame where fecha_venpro='2015-10-07' and codtienda_venpro=123 and archivo_venpro='TRPER20141110A1017.XML' ;]. System.InvalidOperationException: Nested transactions are not supported.
   en MySql.Data.MySqlClient.ExceptionInterceptor.Throw(Exception exception)
   en MySql.Data.MySqlClient.MySqlConnection.Throw(Exception ex)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction(IsolationLevel iso)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction()
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 4968
2015-10-07 0:25:35 : Error.insert_RPE_archivoimport_mysql(). Error en la sentencia. [codtabla: {2} - nomtabla: {frame}
ValorFILA: [33], [1], [0], [0], [7612], [0], [0], [7612], [2014-10-09], [11:07:31], [0], [0], [0], [0], [0], [2411], [173], [521], [0104], []
]Archivo:[TRPER20141009A671.XML]
Fecha: [2015-10-07]
tienda: [1041]
[INSERT INTO frame ( archivo_venpro,fecha_venpro, codtienda_venpro, Tr_Frame, StartofTicket, TenderPurchase, PostVoid, TicketNumber, VoidTicketNumber, NoSale, Tail_NumTicketSL, Tail_Fecha, Tail_Hora, Tail_Devolucion, Tail_Training, Tail_Offline, Tail_TicketCancelado, Tail_BadRec, Sequence_ID, Tail_NumCajero, Tail_NumPOS, StoreNumber, TailSeqHighByte ) 
                                    values ( 'TRPER20141009A671.XML' , '2015-10-07' ,1041, @Tr_Frame, @StartofTicket, @TenderPurchase, @PostVoid, @TicketNumber, @VoidTicketNumber, @NoSale, @Tail_NumTicketSL, @Tail_Fecha, @Tail_Hora, @Tail_Devolucion, @Tail_Training, @Tail_Offline, @Tail_TicketCancelado, @Tail_BadRec, @Sequence_ID, @Tail_NumCajero, @Tail_NumPOS, @StoreNumber, @TailSeqHighByte )] . MySql.Data.MySqlClient.MySqlException (0x80004005): Duplicate entry '2014-10-09-2411-521-104' for key 'PRIMARY'
   en MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   en MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.GetResult(Int32 statementId, Int32& affectedRows, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   en MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery()
   en VENPRO.cldatos.insert_archivoimport_Mysql(MySqlConnection cnMysql_BD, String fecha_venpro, Int64 codtienda_venpro, String archivo_venpro, Int64 codtabla, String nomtabla, String modoactualizacion, Int32 colposicionupdate, Int32 colposicionupdate1, Int32 colposicionupdate2, Int32 colposicionupdate3, Int32 colposicionupdate4, Int32 colposicionupdate5, Int32 colposicionupdate6, Int32 colposicionupdate7, DataRow[] rwcolumnas, List`1 v_columnaxFila, List`1 v_valorxFila) en E:\VENPRO\VENPRO\cldatos.cs:línea 5513
2015-10-07 0:25:35 : procesarxml().Se elimino Archivo.[E:\VENPRO\VENPRO\bin\Debug\import\1041\tmp\TRPER20141009A671.XML] 
2015-10-07 0:25:35 : Error.delete_archivoimport_mysql(). System.NullReferenceException: Referencia a objeto no establecida como instancia de un objeto.
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 5010
2015-10-07 0:25:45 : Error import_archivo.MoveOld(). No se pudo mover  ORIGEN:[E:\VENPRO\VENPRO\bin\Debug\import\1041\tmp\TRPER20141009A671.XML].DESTINO:[E:\VENPRO\VENPRO\bin\Debug\import\1041\old\TRPER20141009A671.XML] System.IO.FileNotFoundException: No se pudo encontrar el archivo 'E:\VENPRO\VENPRO\bin\Debug\import\1041\tmp\TRPER20141009A671.XML'.
Nombre de archivo: 'E:\VENPRO\VENPRO\bin\Debug\import\1041\tmp\TRPER20141009A671.XML'
   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   en System.IO.File.Move(String sourceFileName, String destFileName)
   en VENPRO.Form1.import_archivo(String fecha_venpro, Int64 codtienda, String ruta) en E:\VENPRO\VENPRO\Form1.cs:línea 1643
2015-10-07 0:25:51 : Error.insert_RPE_archivoimport_mysql(). Error en la sentencia. [codtabla: {2} - nomtabla: {frame}
ValorFILA: [33], [1], [0], [0], [1609], [0], [0], [1609], [2014-12-19], [08:06:43], [0], [0], [0], [0], [0], [61029], [6203], [176], [0104], []
]Archivo:[TRPER20141219A456.XML]
Fecha: [2015-10-07]
tienda: [104]
[INSERT INTO frame ( archivo_venpro,fecha_venpro, codtienda_venpro, Tr_Frame, StartofTicket, TenderPurchase, PostVoid, TicketNumber, VoidTicketNumber, NoSale, Tail_NumTicketSL, Tail_Fecha, Tail_Hora, Tail_Devolucion, Tail_Training, Tail_Offline, Tail_TicketCancelado, Tail_BadRec, Sequence_ID, Tail_NumCajero, Tail_NumPOS, StoreNumber, TailSeqHighByte ) 
                                    values ( 'TRPER20141219A456.XML' , '2015-10-07' ,104, @Tr_Frame, @StartofTicket, @TenderPurchase, @PostVoid, @TicketNumber, @VoidTicketNumber, @NoSale, @Tail_NumTicketSL, @Tail_Fecha, @Tail_Hora, @Tail_Devolucion, @Tail_Training, @Tail_Offline, @Tail_TicketCancelado, @Tail_BadRec, @Sequence_ID, @Tail_NumCajero, @Tail_NumPOS, @StoreNumber, @TailSeqHighByte )] . MySql.Data.MySqlClient.MySqlException (0x80004005): Duplicate entry '2014-12-19-61029-176-104' for key 'PRIMARY'
   en MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   en MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.GetResult(Int32 statementId, Int32& affectedRows, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   en MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery()
   en VENPRO.cldatos.insert_archivoimport_Mysql(MySqlConnection cnMysql_BD, String fecha_venpro, Int64 codtienda_venpro, String archivo_venpro, Int64 codtabla, String nomtabla, String modoactualizacion, Int32 colposicionupdate, Int32 colposicionupdate1, Int32 colposicionupdate2, Int32 colposicionupdate3, Int32 colposicionupdate4, Int32 colposicionupdate5, Int32 colposicionupdate6, Int32 colposicionupdate7, DataRow[] rwcolumnas, List`1 v_columnaxFila, List`1 v_valorxFila) en E:\VENPRO\VENPRO\cldatos.cs:línea 5513
2015-10-07 0:25:51 : procesarxml().Se elimino Archivo.[E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A456.XML] 
2015-10-07 0:25:55 : Error.insert_RPE_archivoimport_mysql(). Error en la sentencia. [codtabla: {2} - nomtabla: {frame}
ValorFILA: [33], [1], [0], [0], [1105], [0], [0], [1105], [2014-12-19], [08:23:35], [0], [0], [0], [0], [0], [41776], [6547], [11], [0103], []
]Archivo:[TRPER20141219A468.XML]
Fecha: [2015-10-07]
tienda: [103]
[INSERT INTO frame ( archivo_venpro,fecha_venpro, codtienda_venpro, Tr_Frame, StartofTicket, TenderPurchase, PostVoid, TicketNumber, VoidTicketNumber, NoSale, Tail_NumTicketSL, Tail_Fecha, Tail_Hora, Tail_Devolucion, Tail_Training, Tail_Offline, Tail_TicketCancelado, Tail_BadRec, Sequence_ID, Tail_NumCajero, Tail_NumPOS, StoreNumber, TailSeqHighByte ) 
                                    values ( 'TRPER20141219A468.XML' , '2015-10-07' ,103, @Tr_Frame, @StartofTicket, @TenderPurchase, @PostVoid, @TicketNumber, @VoidTicketNumber, @NoSale, @Tail_NumTicketSL, @Tail_Fecha, @Tail_Hora, @Tail_Devolucion, @Tail_Training, @Tail_Offline, @Tail_TicketCancelado, @Tail_BadRec, @Sequence_ID, @Tail_NumCajero, @Tail_NumPOS, @StoreNumber, @TailSeqHighByte )] . MySql.Data.MySqlClient.MySqlException (0x80004005): Duplicate entry '2014-12-19-41776-11-103' for key 'PRIMARY'
   en MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   en MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.GetResult(Int32 statementId, Int32& affectedRows, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   en MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery()
   en VENPRO.cldatos.insert_archivoimport_Mysql(MySqlConnection cnMysql_BD, String fecha_venpro, Int64 codtienda_venpro, String archivo_venpro, Int64 codtabla, String nomtabla, String modoactualizacion, Int32 colposicionupdate, Int32 colposicionupdate1, Int32 colposicionupdate2, Int32 colposicionupdate3, Int32 colposicionupdate4, Int32 colposicionupdate5, Int32 colposicionupdate6, Int32 colposicionupdate7, DataRow[] rwcolumnas, List`1 v_columnaxFila, List`1 v_valorxFila) en E:\VENPRO\VENPRO\cldatos.cs:línea 5513
2015-10-07 0:25:55 : procesarxml().Se elimino Archivo.[E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A468.XML] 
2015-10-07 0:26:0 : Error import_archivo.MoveOld(). No se pudo mover  ORIGEN:[E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A456.XML].DESTINO:[E:\VENPRO\VENPRO\bin\Debug\import\104\old\TRPER20141219A456.XML] System.IO.FileNotFoundException: No se pudo encontrar el archivo 'E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A456.XML'.
Nombre de archivo: 'E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A456.XML'
   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   en System.IO.File.Move(String sourceFileName, String destFileName)
   en VENPRO.Form1.import_archivo(String fecha_venpro, Int64 codtienda, String ruta) en E:\VENPRO\VENPRO\Form1.cs:línea 1643
2015-10-07 0:26:0 : Error. No se logro importar import_archivo(). [E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1017.XML]
2015-10-07 0:26:2 : Error.delete_archivoimport_mysql().[delete from frame where fecha_venpro='2015-10-07' and codtienda_venpro=104 and archivo_venpro='TRPER20141219A457.XML' ;]. System.InvalidOperationException: Nested transactions are not supported.
   en MySql.Data.MySqlClient.ExceptionInterceptor.Throw(Exception exception)
   en MySql.Data.MySqlClient.MySqlConnection.Throw(Exception ex)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction(IsolationLevel iso)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction()
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 4968
2015-10-07 0:26:2 : Error.delete_archivoimport_mysql().[delete from frame where fecha_venpro='2015-10-07' and codtienda_venpro=123 and archivo_venpro='TRPER20141110A1018.XML' ;]. System.InvalidOperationException: Nested transactions are not supported.
   en MySql.Data.MySqlClient.ExceptionInterceptor.Throw(Exception exception)
   en MySql.Data.MySqlClient.MySqlConnection.Throw(Exception ex)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction(IsolationLevel iso)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction()
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 4968
2015-10-07 0:26:2 : Error import_archivo.MoveOld(). No se pudo mover  ORIGEN:[E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A468.XML].DESTINO:[E:\VENPRO\VENPRO\bin\Debug\import\103\old\TRPER20141219A468.XML] System.IO.FileNotFoundException: No se pudo encontrar el archivo 'E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A468.XML'.
Nombre de archivo: 'E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A468.XML'
   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   en System.IO.File.Move(String sourceFileName, String destFileName)
   en VENPRO.Form1.import_archivo(String fecha_venpro, Int64 codtienda, String ruta) en E:\VENPRO\VENPRO\Form1.cs:línea 1643
2015-10-07 0:26:6 : Error.delete_archivoimport_mysql(). System.NullReferenceException: Referencia a objeto no establecida como instancia de un objeto.
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 5010
2015-10-07 0:26:6 : Error.delete_archivoimport_mysql(). System.NullReferenceException: Referencia a objeto no establecida como instancia de un objeto.
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 5010
2015-10-07 0:26:22 : Error.delete_archivoimport_mysql().[delete from frame where fecha_venpro='2015-10-07' and codtienda_venpro=103 and archivo_venpro='TRPER20141219A443.XML' ;]. System.InvalidOperationException: Nested transactions are not supported.
   en MySql.Data.MySqlClient.ExceptionInterceptor.Throw(Exception exception)
   en MySql.Data.MySqlClient.MySqlConnection.Throw(Exception ex)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction(IsolationLevel iso)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction()
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 4968
2015-10-07 0:26:28 : Error.delete_archivoimport_mysql(). System.NullReferenceException: Referencia a objeto no establecida como instancia de un objeto.
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 5010
2015-10-07 0:26:29 : Error. No se logro importar import_archivo(). [E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1018.XML]
2015-10-07 0:26:29 : Error. No se logro importar import_archivo(). [E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A457.XML]
2015-10-07 0:26:29 : Error. No se logro importar import_archivo(). [E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A443.XML]
2015-10-07 0:26:44 : VENPRO Cerrado.
2015-10-07 0:26:46 : Error.insert_RPE_archivoimport_mysql(). Error en la sentencia. [codtabla: {2} - nomtabla: {frame}
ValorFILA: [33], [1], [0], [0], [1098], [0], [0], [1098], [2014-12-19], [08:07:13], [0], [0], [0], [0], [0], [41364], [6547], [11], [0103], []
]Archivo:[TRPER20141219A447.XML]
Fecha: [2015-10-07]
tienda: [103]
[INSERT INTO frame ( archivo_venpro,fecha_venpro, codtienda_venpro, Tr_Frame, StartofTicket, TenderPurchase, PostVoid, TicketNumber, VoidTicketNumber, NoSale, Tail_NumTicketSL, Tail_Fecha, Tail_Hora, Tail_Devolucion, Tail_Training, Tail_Offline, Tail_TicketCancelado, Tail_BadRec, Sequence_ID, Tail_NumCajero, Tail_NumPOS, StoreNumber, TailSeqHighByte ) 
                                    values ( 'TRPER20141219A447.XML' , '2015-10-07' ,103, @Tr_Frame, @StartofTicket, @TenderPurchase, @PostVoid, @TicketNumber, @VoidTicketNumber, @NoSale, @Tail_NumTicketSL, @Tail_Fecha, @Tail_Hora, @Tail_Devolucion, @Tail_Training, @Tail_Offline, @Tail_TicketCancelado, @Tail_BadRec, @Sequence_ID, @Tail_NumCajero, @Tail_NumPOS, @StoreNumber, @TailSeqHighByte )] . MySql.Data.MySqlClient.MySqlException (0x80004005): Duplicate entry '2014-12-19-41364-11-103' for key 'PRIMARY'
   en MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   en MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.GetResult(Int32 statementId, Int32& affectedRows, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   en MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery()
   en VENPRO.cldatos.insert_archivoimport_Mysql(MySqlConnection cnMysql_BD, String fecha_venpro, Int64 codtienda_venpro, String archivo_venpro, Int64 codtabla, String nomtabla, String modoactualizacion, Int32 colposicionupdate, Int32 colposicionupdate1, Int32 colposicionupdate2, Int32 colposicionupdate3, Int32 colposicionupdate4, Int32 colposicionupdate5, Int32 colposicionupdate6, Int32 colposicionupdate7, DataRow[] rwcolumnas, List`1 v_columnaxFila, List`1 v_valorxFila) en E:\VENPRO\VENPRO\cldatos.cs:línea 5513
2015-10-07 0:26:46 : procesarxml().Se elimino Archivo.[E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A447.XML] 
2015-10-07 0:26:48 : Error import_archivo.MoveOld(). No se pudo mover  ORIGEN:[E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A447.XML].DESTINO:[E:\VENPRO\VENPRO\bin\Debug\import\103\old\TRPER20141219A447.XML] System.IO.FileNotFoundException: No se pudo encontrar el archivo 'E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A447.XML'.
Nombre de archivo: 'E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A447.XML'
   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   en System.IO.File.Move(String sourceFileName, String destFileName)
   en VENPRO.Form1.import_archivo(String fecha_venpro, Int64 codtienda, String ruta) en E:\VENPRO\VENPRO\Form1.cs:línea 1643
2015-10-07 0:26:49 : Error.insert_RPE_archivoimport_mysql(). Error en la sentencia. [codtabla: {2} - nomtabla: {frame}
ValorFILA: [33], [1], [0], [0], [7612], [0], [0], [7612], [2014-10-09], [11:07:31], [0], [0], [0], [0], [0], [2411], [173], [521], [0104], []
]Archivo:[TRPER20141009A671.XML]
Fecha: [2015-10-07]
tienda: [1041]
[INSERT INTO frame ( archivo_venpro,fecha_venpro, codtienda_venpro, Tr_Frame, StartofTicket, TenderPurchase, PostVoid, TicketNumber, VoidTicketNumber, NoSale, Tail_NumTicketSL, Tail_Fecha, Tail_Hora, Tail_Devolucion, Tail_Training, Tail_Offline, Tail_TicketCancelado, Tail_BadRec, Sequence_ID, Tail_NumCajero, Tail_NumPOS, StoreNumber, TailSeqHighByte ) 
                                    values ( 'TRPER20141009A671.XML' , '2015-10-07' ,1041, @Tr_Frame, @StartofTicket, @TenderPurchase, @PostVoid, @TicketNumber, @VoidTicketNumber, @NoSale, @Tail_NumTicketSL, @Tail_Fecha, @Tail_Hora, @Tail_Devolucion, @Tail_Training, @Tail_Offline, @Tail_TicketCancelado, @Tail_BadRec, @Sequence_ID, @Tail_NumCajero, @Tail_NumPOS, @StoreNumber, @TailSeqHighByte )] . MySql.Data.MySqlClient.MySqlException (0x80004005): Duplicate entry '2014-10-09-2411-521-104' for key 'PRIMARY'
   en MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   en MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.GetResult(Int32 statementId, Int32& affectedRows, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   en MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery()
   en VENPRO.cldatos.insert_archivoimport_Mysql(MySqlConnection cnMysql_BD, String fecha_venpro, Int64 codtienda_venpro, String archivo_venpro, Int64 codtabla, String nomtabla, String modoactualizacion, Int32 colposicionupdate, Int32 colposicionupdate1, Int32 colposicionupdate2, Int32 colposicionupdate3, Int32 colposicionupdate4, Int32 colposicionupdate5, Int32 colposicionupdate6, Int32 colposicionupdate7, DataRow[] rwcolumnas, List`1 v_columnaxFila, List`1 v_valorxFila) en E:\VENPRO\VENPRO\cldatos.cs:línea 5513
2015-10-07 0:26:49 : procesarxml().Se elimino Archivo.[E:\VENPRO\VENPRO\bin\Debug\import\1041\tmp\TRPER20141009A671.XML] 
2015-10-07 0:26:56 : Error.insert_RPE_archivoimport_mysql(). Error en la sentencia. [codtabla: {2} - nomtabla: {frame}
ValorFILA: [33], [1], [0], [0], [1614], [0], [0], [1614], [2014-12-19], [08:09:02], [0], [0], [0], [0], [0], [61232], [6203], [176], [0104], []
]Archivo:[TRPER20141219A458.XML]
Fecha: [2015-10-07]
tienda: [104]
[INSERT INTO frame ( archivo_venpro,fecha_venpro, codtienda_venpro, Tr_Frame, StartofTicket, TenderPurchase, PostVoid, TicketNumber, VoidTicketNumber, NoSale, Tail_NumTicketSL, Tail_Fecha, Tail_Hora, Tail_Devolucion, Tail_Training, Tail_Offline, Tail_TicketCancelado, Tail_BadRec, Sequence_ID, Tail_NumCajero, Tail_NumPOS, StoreNumber, TailSeqHighByte ) 
                                    values ( 'TRPER20141219A458.XML' , '2015-10-07' ,104, @Tr_Frame, @StartofTicket, @TenderPurchase, @PostVoid, @TicketNumber, @VoidTicketNumber, @NoSale, @Tail_NumTicketSL, @Tail_Fecha, @Tail_Hora, @Tail_Devolucion, @Tail_Training, @Tail_Offline, @Tail_TicketCancelado, @Tail_BadRec, @Sequence_ID, @Tail_NumCajero, @Tail_NumPOS, @StoreNumber, @TailSeqHighByte )] . MySql.Data.MySqlClient.MySqlException (0x80004005): Duplicate entry '2014-12-19-61232-176-104' for key 'PRIMARY'
   en MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   en MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.GetResult(Int32 statementId, Int32& affectedRows, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   en MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery()
   en VENPRO.cldatos.insert_archivoimport_Mysql(MySqlConnection cnMysql_BD, String fecha_venpro, Int64 codtienda_venpro, String archivo_venpro, Int64 codtabla, String nomtabla, String modoactualizacion, Int32 colposicionupdate, Int32 colposicionupdate1, Int32 colposicionupdate2, Int32 colposicionupdate3, Int32 colposicionupdate4, Int32 colposicionupdate5, Int32 colposicionupdate6, Int32 colposicionupdate7, DataRow[] rwcolumnas, List`1 v_columnaxFila, List`1 v_valorxFila) en E:\VENPRO\VENPRO\cldatos.cs:línea 5513
2015-10-07 0:26:56 : procesarxml().Se elimino Archivo.[E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A458.XML] 
2015-10-07 0:26:59 : Error.insert_RPE_archivoimport_mysql(). Error en la sentencia. [codtabla: {2} - nomtabla: {frame}
ValorFILA: [33], [1], [0], [0], [5559], [0], [0], [5559], [2014-11-10], [17:31:12], [0], [0], [0], [0], [0], [64065], [4016], [17], [0123], [8]
]Archivo:[TRPER20141110A1021.XML]
Fecha: [2015-10-07]
tienda: [123]
[INSERT INTO frame ( archivo_venpro,fecha_venpro, codtienda_venpro, Tr_Frame, StartofTicket, TenderPurchase, PostVoid, TicketNumber, VoidTicketNumber, NoSale, Tail_NumTicketSL, Tail_Fecha, Tail_Hora, Tail_Devolucion, Tail_Training, Tail_Offline, Tail_TicketCancelado, Tail_BadRec, Sequence_ID, Tail_NumCajero, Tail_NumPOS, StoreNumber, TailSeqHighByte ) 
                                    values ( 'TRPER20141110A1021.XML' , '2015-10-07' ,123, @Tr_Frame, @StartofTicket, @TenderPurchase, @PostVoid, @TicketNumber, @VoidTicketNumber, @NoSale, @Tail_NumTicketSL, @Tail_Fecha, @Tail_Hora, @Tail_Devolucion, @Tail_Training, @Tail_Offline, @Tail_TicketCancelado, @Tail_BadRec, @Sequence_ID, @Tail_NumCajero, @Tail_NumPOS, @StoreNumber, @TailSeqHighByte )] . MySql.Data.MySqlClient.MySqlException (0x80004005): Duplicate entry '2014-11-10-64065-17-123' for key 'PRIMARY'
   en MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   en MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.GetResult(Int32 statementId, Int32& affectedRows, Int64& insertedId)
   en MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   en MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteReader()
   en MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery()
   en VENPRO.cldatos.insert_archivoimport_Mysql(MySqlConnection cnMysql_BD, String fecha_venpro, Int64 codtienda_venpro, String archivo_venpro, Int64 codtabla, String nomtabla, String modoactualizacion, Int32 colposicionupdate, Int32 colposicionupdate1, Int32 colposicionupdate2, Int32 colposicionupdate3, Int32 colposicionupdate4, Int32 colposicionupdate5, Int32 colposicionupdate6, Int32 colposicionupdate7, DataRow[] rwcolumnas, List`1 v_columnaxFila, List`1 v_valorxFila) en E:\VENPRO\VENPRO\cldatos.cs:línea 5513
2015-10-07 0:26:59 : procesarxml().Se elimino Archivo.[E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1021.XML] 
2015-10-07 0:26:59 : Error import_archivo.MoveOld(). No se pudo mover  ORIGEN:[E:\VENPRO\VENPRO\bin\Debug\import\1041\tmp\TRPER20141009A671.XML].DESTINO:[E:\VENPRO\VENPRO\bin\Debug\import\1041\old\TRPER20141009A671.XML] System.IO.FileNotFoundException: No se pudo encontrar el archivo 'E:\VENPRO\VENPRO\bin\Debug\import\1041\tmp\TRPER20141009A671.XML'.
Nombre de archivo: 'E:\VENPRO\VENPRO\bin\Debug\import\1041\tmp\TRPER20141009A671.XML'
   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   en System.IO.File.Move(String sourceFileName, String destFileName)
   en VENPRO.Form1.import_archivo(String fecha_venpro, Int64 codtienda, String ruta) en E:\VENPRO\VENPRO\Form1.cs:línea 1643
2015-10-07 0:26:59 : Error.delete_archivoimport_mysql().[delete from frame where fecha_venpro='2015-10-07' and codtienda_venpro=103 and archivo_venpro='TRPER20141219A449.XML' ;]. System.InvalidOperationException: Nested transactions are not supported.
   en MySql.Data.MySqlClient.ExceptionInterceptor.Throw(Exception exception)
   en MySql.Data.MySqlClient.MySqlConnection.Throw(Exception ex)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction(IsolationLevel iso)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction()
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 4968
2015-10-07 0:27:5 : Error import_archivo.MoveOld(). No se pudo mover  ORIGEN:[E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A458.XML].DESTINO:[E:\VENPRO\VENPRO\bin\Debug\import\104\old\TRPER20141219A458.XML] System.IO.FileNotFoundException: No se pudo encontrar el archivo 'E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A458.XML'.
Nombre de archivo: 'E:\VENPRO\VENPRO\bin\Debug\import\104\tmp\TRPER20141219A458.XML'
   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   en System.IO.File.Move(String sourceFileName, String destFileName)
   en VENPRO.Form1.import_archivo(String fecha_venpro, Int64 codtienda, String ruta) en E:\VENPRO\VENPRO\Form1.cs:línea 1643
2015-10-07 0:27:5 : Error procesarxml(). [E:\VENPRO\VENPRO\bin\Debug\import\118\tmp][E:\VENPRO\VENPRO\bin\Debug\import\118\tmp\TRPER20141009A1155.XML] [tag1: 
tag2: 
tag3_tabla: 
tag4_columna: 
tag4_columna_valor: 
MySql.Data.MySqlClient.MySqlException (0x80004005): Authentication to host 'localhost' for user 'root' using method 'mysql_native_password' failed with message: Reading from the stream has failed. ---> MySql.Data.MySqlClient.MySqlException (0x80004005): Reading from the stream has failed. ---> System.IO.IOException: No se puede escribir datos de en la conexión de transporte: Se ha anulado una conexión establecida por el software en su equipo host. ---> System.Net.Sockets.SocketException: Se ha anulado una conexión establecida por el software en su equipo host
   en System.Net.Sockets.Socket.Receive(Byte[] buffer, Int32 offset, Int32 size, SocketFlags socketFlags)
   en System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset, Int32 size)
   --- Fin del seguimiento de la pila de la excepción interna ---
   en MySql.Data.Common.MyNetworkStream.HandleOrRethrowException(Exception e)
   en MySql.Data.Common.MyNetworkStream.Read(Byte[] buffer, Int32 offset, Int32 count)
   en MySql.Data.MySqlClient.TimedStream.Read(Byte[] buffer, Int32 offset, Int32 count)
   en System.IO.BufferedStream.Read(Byte[] array, Int32 offset, Int32 count)
   en MySql.Data.MySqlClient.MySqlStream.ReadFully(Stream stream, Byte[] buffer, Int32 offset, Int32 count)
   en MySql.Data.MySqlClient.MySqlStream.LoadPacket()
   en MySql.Data.MySqlClient.MySqlStream.LoadPacket()
   en MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   en MySql.Data.MySqlClient.NativeDriver.ReadPacket()
   en MySql.Data.MySqlClient.Authentication.MySqlAuthenticationPlugin.ReadPacket()
   en MySql.Data.MySqlClient.Authentication.MySqlAuthenticationPlugin.AuthenticationFailed(Exception ex)
   en MySql.Data.MySqlClient.Authentication.MySqlAuthenticationPlugin.ReadPacket()
   en MySql.Data.MySqlClient.Authentication.MySqlAuthenticationPlugin.Authenticate(Boolean reset)
   en MySql.Data.MySqlClient.NativeDriver.Authenticate(String authMethod, Boolean reset)
   en MySql.Data.MySqlClient.NativeDriver.Open()
   en MySql.Data.MySqlClient.Driver.Open()
   en MySql.Data.MySqlClient.Driver.Create(MySqlConnectionStringBuilder settings)
   en MySql.Data.MySqlClient.MySqlPool.CreateNewPooledConnection()
   en MySql.Data.MySqlClient.MySqlPool.GetPooledConnection()
   en MySql.Data.MySqlClient.MySqlPool.TryToGetDriver()
   en MySql.Data.MySqlClient.MySqlPool.GetConnection()
   en MySql.Data.MySqlClient.MySqlConnection.Open()
   en VENPRO.Form1.procesarxml(String fecha_venpro, Int64 codtienda, String ruta, String arch) en E:\VENPRO\VENPRO\Form1.cs:línea 806
2015-10-07 0:27:5 : Error. No se logro importar import_archivo(). [E:\VENPRO\VENPRO\bin\Debug\import\118\tmp\TRPER20141009A1155.XML]
2015-10-07 0:27:12 : Error.delete_archivoimport_mysql().[delete from frame where fecha_venpro='2015-10-07' and codtienda_venpro=118 and archivo_venpro='TRPER20141009A1156.XML' ;]. System.InvalidOperationException: Nested transactions are not supported.
   en MySql.Data.MySqlClient.ExceptionInterceptor.Throw(Exception exception)
   en MySql.Data.MySqlClient.MySqlConnection.Throw(Exception ex)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction(IsolationLevel iso)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction()
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 4968
2015-10-07 0:27:12 : Error.delete_archivoimport_mysql(). System.NullReferenceException: Referencia a objeto no establecida como instancia de un objeto.
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 5010
2015-10-07 0:27:12 : Error. No se logro importar import_archivo(). [E:\VENPRO\VENPRO\bin\Debug\import\103\tmp\TRPER20141219A449.XML]
2015-10-07 0:27:12 : Error import_archivo.MoveOld(). No se pudo mover  ORIGEN:[E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1021.XML].DESTINO:[E:\VENPRO\VENPRO\bin\Debug\import\123\old\TRPER20141110A1021.XML] System.IO.FileNotFoundException: No se pudo encontrar el archivo 'E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1021.XML'.
Nombre de archivo: 'E:\VENPRO\VENPRO\bin\Debug\import\123\tmp\TRPER20141110A1021.XML'
   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   en System.IO.File.Move(String sourceFileName, String destFileName)
   en VENPRO.Form1.import_archivo(String fecha_venpro, Int64 codtienda, String ruta) en E:\VENPRO\VENPRO\Form1.cs:línea 1643
2015-10-07 0:27:17 : Error.delete_archivoimport_mysql().[delete from frame where fecha_venpro='2015-10-07' and codtienda_venpro=104 and archivo_venpro='TRPER20141219A459.XML' ;]. System.InvalidOperationException: Nested transactions are not supported.
   en MySql.Data.MySqlClient.ExceptionInterceptor.Throw(Exception exception)
   en MySql.Data.MySqlClient.MySqlConnection.Throw(Exception ex)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction(IsolationLevel iso)
   en MySql.Data.MySqlClient.MySqlConnection.BeginTransaction()
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 4968
2015-10-07 0:27:17 : Error.delete_archivoimport_mysql(). System.NullReferenceException: Referencia a objeto no establecida como instancia de un objeto.
   en VENPRO.cldatos.delete_archivoimport_mysql(MySqlConnection cn, String tabla, String columfecha, String valfecha, String columcodtienda, Int64 codtienda, String columarchivo, String archivo) en E:\VENPRO\VENPRO\cldatos.cs:línea 5010
2015-10-07 0:27:17 : Error. No se logro importar import_archivo(). [E:\VENPRO\VENPRO\bin\Debug\import\118\tmp\TRPER20141009A1156.XML]
